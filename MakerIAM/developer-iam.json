{
    "Resources": {
        "SquidsEC2Role" : {
            "Type" : "AWS::IAM::Role",
            "Properties" : {
                "AssumeRolePolicyDocument": {
                    "Version": "2012-10-17",
                    "Statement": [
                        {
                            "Effect": "Allow",
                            "Principal": {
                                "Service": [
                                    "ec2.amazonaws.com"
                                ]
                            },
                            "Action": [
                                "sts:AssumeRole"
                            ]
                        }
                    ]
                },
                "Path": "/",
                "RoleName" : "SquidsEC2Role"
            },
        },
        "SquidsEC2Policy" : {
            "Type" : "AWS::IAM::ManagedPolicy",
            "Properties" : {
                "ManagedPolicyName" : "SquidsEC2Policy",
                "PolicyDocument" : {
                    "Version" : "2012-10-17",
                    "Statement": [
                        {
                            "Action": [
                                "autoscaling:*"
                            ],
                            "Resource": "*",
                            "Effect": "Allow",
                            "Sid": "Ec2AutoScaleAllowDeveloper"
                        },
                        {
                            "Action": [
                                "ec2:AllocateAddress",
                                "ec2:AllocateHosts",
                                "ec2:AssignIpv6Addresses",
                                "ec2:AssignPrivateIpAddresses",
                                "ec2:AssociateAddress",
                                "ec2:AssociateDhcpOptions",
                                "ec2:AssociateIamInstanceProfile",
                                "ec2:AttachNetworkInterface",
                                "ec2:AttachVolume",
                                "ec2:BundleInstance",
                                "ec2:CancelBundleTask",
                                "ec2:CancelConversionTask",
                                "ec2:CancelExportTask",
                                "ec2:CancelSpotInstanceRequests",
                                "ec2:ConfirmProductInstance",
                                "ec2:CopyImage",
                                "ec2:CopySnapshot",
                                "ec2:CreateImage",
                                "ec2:CreateInstanceExportTask",
                                "ec2:CreateKeyPair",
                                "ec2:CreateNetworkInterface",
                                "ec2:CreatePlacementGroup",
                                "ec2:CreateSnapshot",
                                "ec2:CreateSpotDatafeedSubscription",
                                "ec2:CreateTags",
                                "ec2:CreateVolume",
                                "ec2:DeleteKeyPair",
                                "ec2:DeleteNetworkInterface",
                                "ec2:DeletePlacementGroup",
                                "ec2:DeleteSnapshot",
                                "ec2:DeleteSpotDatafeedSubscription",
                                "ec2:DeleteTags",
                                "ec2:DeleteVolume",
                                "ec2:DeregisterImage",
                                "ec2:DetachNetworkInterface",
                                "ec2:DetachVolume",
                                "ec2:DisassociateAddress",
                                "ec2:DisassociateIamInstanceProfile",
                                "ec2:EnableVolumeIO",
                                "ec2:GetConsoleOutput",
                                "ec2:GetPasswordData",
                                "ec2:GetReservedInstancesExchangeQuote",
                                "ec2:ImportInstance",
                                "ec2:ImportKeyPair",
                                "ec2:ImportVolume",
                                "ec2:ModifyInstanceAttribute",
                                "ec2:ModifyInstanceCreditSpecification",
                                "ec2:ModifyNetworkInterfaceAttribute",
                                "ec2:ModifySnapshotAttribute",
                                "ec2:ModifyVolume",
                                "ec2:ModifyVolumeAttribute",
                                "ec2:MonitorInstances",
                                "ec2:RebootInstances",
                                "ec2:RegisterImage",
                                "ec2:ReleaseAddress",
                                "ec2:ReplaceIamInstanceProfileAssociation",
                                "ec2:ReportInstanceStatus",
                                "ec2:RequestSpotInstances",
                                "ec2:ResetImageAttribute",
                                "ec2:ResetInstanceAttribute",
                                "ec2:ResetNetworkInterfaceAttribute",
                                "ec2:ResetSnapshotAttribute",
                                "ec2:RunInstances",
                                "ec2:StartInstances",
                                "ec2:StopInstances",
                                "ec2:TerminateInstances",
                                "ec2:UnassignPrivateIpAddresses",
                                "ec2:UnmonitorInstances"
                            ],
                            "Resource": "*",
                            "Effect": "Allow",
                            "Sid": "EC2AllowDeveloper"
                        }
                    ]
                },
                "Path" : "/",
                "Roles" : [ { "Ref" : "SquidsEC2Role" } ]
            },
        },
        "SquidsIAMPolicy" : {
            "Type" : "AWS::IAM::ManagedPolicy",
            "Properties" : {
                "ManagedPolicyName" : "SquidsIAMPolicy",
                "PolicyDocument" : {
                    "Version": "2012-10-17",
                    "Statement": [
                        {
                            "Sid": "VisualEditor0",
                            "Effect": "Allow",
                            "Action": [
                                "iam:CreatePolicy",
                                "iam:GetRole",
                                "iam:CreateRole",
                                "iam:PutRolePolicy"
                            ],
                            "Resource": "*"
                        }
                    ]
                },
                "Path" : "/",
                "Roles" : [ { "Ref" : "SquidsEC2Role" } ]
            },
        },
        "SquidsCFTPolicy" : {
            "Type" : "AWS::IAM::ManagedPolicy",
            "Properties" : {
                "ManagedPolicyName" : "SquidsCFTPolicy",
                "PolicyDocument" : {
                    "Version": "2012-10-17",
                    "Statement": [
                        {
                            "Sid": "VisualEditor0",
                            "Effect": "Allow",
                            "Action": [
                                "cloudformation:ListStacks",
                                "cloudformation:CreateStack",
                                "cloudformation:UpdateStack"
                            ],
                            "Resource": "*"
                        }
                    ]
                },
                "Path" : "/",
                "Roles" : [ { "Ref" : "SquidsEC2Role" } ]
            },
        },
        "SquidsInstanceProfile" : {
            "Type" : "AWS::IAM::InstanceProfile",
            "Properties" : {
                "InstanceProfileName" : "SquidsEC2Role",
                "Path" : "/",
                "Roles" : [ { "Ref" : "SquidsEC2Role" } ]
            },
        }
    }
}
